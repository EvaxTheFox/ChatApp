<!DOCTYPE html>
<html ng-app="messageApp">
<head>

 <! â€” include bootstap and jquery cdn ->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>


<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<script src="/angular/angular.js"></script>
<script src="app.js"></script>
</head>
<body ng-controller="messageController">
<div class="container">
 <br>
 <div class="jumbotron">
 <h1 class="display-4">Send Message</h1>
 <br>
 <input id = "name" class="form-control" placeholder="Name" ng-model="Message.name">
 <br>
 <textarea id = "message" class="form-control" placeholder="Your Message Here" ng-model="Message.message">
</textarea>
 <br>
 <button id="send" class="btn btn-success" ng-click="submit()">Send</button>
 </div>
 <div id="messages">
 
</div>

<ul>
  <li ng-repeat="message in messages">
	  <span>{{message.name}}</span>
          <p>{{message.message}}</p>
  </li> 
</ul>
</div>
<script src="/socket.io/socket.io.js"></script>
<script>
  $(() => {
    $("#send").click(()=>{
       sendMessage({
          name: $("#name").val(), 
          message:$("#message").val()});
        })
      getMessages()
    })
    
function addMessages(message){
var appendMsg = ' <p>'+  message.name+ ':' +  message.message + '</p>';
//$("#messages").append(appendMsg);
  }
   
function getMessages(){
  $.get('http://localhost:3000/messages', (data) => {
   data.forEach(addMessages);
   })
 }
 
function sendMessage(message){
   //$.post('http://localhost:3000/messages', message)
 }


var socket = io();
socket.on('message', addMessages);
</script>
</body>
</html>
